// Adapted from DaviesGit/SysY_compiler:
// https://raw.githubusercontent.com/DaviesGit/SysY_compiler/master/test_sample/performance_test/01_mm1.sy
// Changes:
// - Flatten 2D arrays into 1D arrays (SysY 2025 only supports 1D arrays).
// - Remove getint/starttime/stoptime/putint/putch; generate data and print a checksum.
// - Replace while with for loops.

const int N = 12;
const int NN = N * N;
const int MOD = 10007;

int A[NN] = {};
int B[NN] = {};
int C[NN] = {};

int prng() {
    static int s = 1;
    s = (s * 97 + 17) % MOD;
    return s;
}

void init_mat(int n, int a[], int salt) {
    int nn = n * n;
    int i = 0;
    for (i = 0; i < nn; i = i + 1) {
        int v = (prng() + salt + i) % 13;
        if (i % (n + 1) == 0) v = 0;
        a[i] = v;
    }
}

void mm(int n, int A[], int B[], int C[]) {
    int i, j, k;

    for (i = 0; i < n; i = i + 1) {
        for (j = 0; j < n; j = j + 1) {
            C[i * n + j] = 0;
        }
    }

    for (k = 0; k < n; k = k + 1) {
        for (i = 0; i < n; i = i + 1) {
            int aik = A[i * n + k];
            if (aik == 0) continue;

            for (j = 0; j < n; j = j + 1) {
                int idx = i * n + j;
                int tmp = C[idx] + aik * B[k * n + j];
                C[idx] = tmp % MOD;
            }
        }
    }
}

int main() {
    init_mat(N, A, 3);
    init_mat(N, B, 5);

    int it = 0;
    for (it = 0; it < 5; it = it + 1) {
        mm(N, A, B, C);
        mm(N, A, C, B);
    }

    int ans = 0;
    int i = 0;
    for (i = 0; i < NN; i = i + 1) {
        ans = (ans + B[i]) % MOD;
    }

    printf("%d\n", ans);
    return 0;
}
